var gigPageFirstLoaded=!1,gigList=new Array,futureGigs=!1,futureGigList=new Array,pastGigList=new Array,todayDate=new Date;function Gig(date,event,info,venue,city,country,bandList,ticketLink,doorsTime,stageTime,eventLink,ticketLink,photoFolder,promoPoster,gigPicture){this.Date=date,this.Event=event,this.Info=info,this.Venue=venue,this.City=city,this.Country=country,this.BandList=bandList,this.TicketLink=ticketLink,this.DoorsTime=doorsTime,this.StageTime=stageTime,this.EventLink=null==eventLink?"":eventLink,this.TicketLink=null==ticketLink?"":ticketLink,this.PhotoFolder=null==photoFolder?"":photoFolder,this.PromoPoster=promoPoster,this.GigPicture=gigPicture}function SetupGigs(data){for(i=1;i<data.values.length;i++)gigList.push(new Gig(new Date(data.values[i][0]),data.values[i][1],data.values[i][2],data.values[i][3],data.values[i][4],data.values[i][5],data.values[i][6],data.values[i][7],data.values[i][8],data.values[i][9],data.values[i][10],data.values[i][11],data.values[i][12],data.values[i][13],data.values[i][14]));for(i=0;i<gigList.length;i++)gigList[i].Date>=todayDate?(futureGigList.push(gigList[i]),futureGigs=!0):pastGigList.push(gigList[i]);for(pastGigList.sort((a,b)=>b.Date-a.Date),futureGigList.sort((a,b)=>a.Date-b.Date),gigList=new Array,i=0;i<futureGigList.length;i++)gigList.push(futureGigList[i]);for(i=0;i<pastGigList.length;i++)gigList.push(pastGigList[i]);gigPageFirstLoaded?BuildGigsDisplay():BuildHomePageNextGig()}function BuildHomePageNextGig(){if(futureGigs){var panelWidth,pictureWidth=$("#MainContent_CoverImage").width()/100*25-20,pictureHeight=pictureWidth/.75,itemTemplate=$("#GigItem_Template").html(),gigTitleTemplate,html="",lastGigYear=0;html+=$("#GigSectionTitle_Template").html().replace("$TITLE$","Next gig").replace("$UPCOMING$","upcoming"),html+=itemTemplate.replace(/\$PROMOPOSTER\$/g,gigList[0].PromoPoster).replace(/\$DATE\$/g,gigList[0].Date.toLocaleDateString("en-GB",dateOptions)).replace(/\$EVENT\$/g,gigList[0].Event).replace(/\$VENUE\$/g,gigList[0].Venue).replace(/\$INFO\$/g,gigList[0].Info).replace(/\$CITY\$/g,gigList[0].City).replace(/\$COUNTRY\$/g,gigList[0].Country).replace(/\$DOORSTIME\$/g,gigList[0].DoorsTime).replace(/\$STAGETIME\$/g,gigList[0].StageTime).replace(/\$EVENTLINK\$/g,gigList[0].EventLink).replace(/\$TICKETLINK\$/g,gigList[0].TicketLink).replace(/\$EVENTLINKSHOW\$/g,""==gigList[0].EventLink?"hide":gigList[0].EventLink).replace(/\$TICKETLINKSHOW\$/g,""==gigList[0].TicketLink?"hide":gigList[0].TicketLink).replace(/\$GIGPICTURE\$/g,gigList[0].GigPicture).replace("$UPCOMING$","upcoming").replace(/\$PHOTOFOLDER\$/g,GetCleanFolderName(gigList[0].PhotoFolder)),$("#MainContent_CoverImage").after(html),$(".gigitemleft").width(pictureWidth).height(pictureHeight),$(".gigitemright").width(pictureWidth).height(pictureHeight)}}function BuildGigsDisplay(){if(!loadedTabs.includes("Gigs"))return GetData("Gigs",SetupGigs),void(gigPageFirstLoaded=!0);gigPageFirstLoaded=!1;var panelWidth,pictureWidth=$("#TabContent_5").width()/100*25-20,pictureHeight=pictureWidth/.75,itemTemplate=$("#GigItem_Template").html(),gigTitleTemplate=$("#GigSectionTitle_Template").html(),html="",lastGigYear=0;html+=gigTitleTemplate.replace("$TITLE$","Upcoming gigs").replace("$UPCOMING$","upcoming");var nextYearGig=!1;for(i=0;i<gigList.length;i++){var gigDate=gigList[i].Date.getFullYear()+"-"+(gigList[i].Date.getMonth()+1)+"-"+gigList[i].Date.getDate(),tomorrowDate,upcoming="upcoming";gigDate==(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+((new Date).getDate()+1)?html+=gigTitleTemplate.replace("$TITLE$","Tomorrow!").replace("$UPCOMING$","upcoming"):gigDate==(new Date).getFullYear()+"-"+((new Date).getMonth()+1)+"-"+(new Date).getDate()?html+=gigTitleTemplate.replace("$TITLE$","Today!").replace("$UPCOMING$","upcoming"):gigList[i].Date.getFullYear()!=(new Date).getFullYear()+1||nextYearGig?gigList[i].Date<=todayDate&&(lastGigYear!=gigList[i].Date.getFullYear()&&(html+=gigTitleTemplate.replace("$TITLE$",gigList[i].Date.getFullYear()).replace("$UPCOMING$","")),lastGigYear=gigList[i].Date.getFullYear(),upcoming=""):(html+=gigTitleTemplate.replace("$TITLE$",((new Date).getFullYear()+1).toString()).replace("$UPCOMING$","upcoming"),nextYearGig=!0),html+=itemTemplate.replace(/\$PROMOPOSTER\$/g,gigList[i].PromoPoster).replace(/\$DATE\$/g,gigList[i].Date.toLocaleDateString("en-GB",dateOptions)).replace(/\$EVENT\$/g,gigList[i].Event).replace(/\$VENUE\$/g,gigList[i].Venue).replace(/\$INFO\$/g,gigList[i].Info).replace(/\$CITY\$/g,gigList[i].City).replace(/\$COUNTRY\$/g,gigList[i].Country).replace(/\$DOORSTIME\$/g,gigList[i].DoorsTime).replace(/\$STAGETIME\$/g,gigList[i].StageTime).replace(/\$EVENTLINK\$/g,gigList[i].EventLink).replace(/\$TICKETLINK\$/g,gigList[i].TicketLink).replace(/\$EVENTLINKSHOW\$/g,""==gigList[i].EventLink?"hide":gigList[i].EventLink).replace(/\$TICKETLINKSHOW\$/g,""==gigList[i].TicketLink?"hide":gigList[i].TicketLink).replace(/\$GIGPICTURE\$/g,gigList[i].GigPicture).replace("$UPCOMING$",upcoming).replace(/\$PHOTOFOLDER\$/g,GetCleanFolderName(gigList[i].PhotoFolder))}$("#TabContent_5").html(html),$(".gigitemleft").width(pictureWidth).height(pictureHeight),$(".gigitemright").width(pictureWidth).height(pictureHeight)}todayDate.setHours(0),todayDate.setMinutes(0),todayDate.setSeconds(0),todayDate.setMilliseconds(0);